Curve Fit Summary
========================================================

***Model Equation***

```{r modelEquation, message = FALSE, results='asis', echo=FALSE, cache=FALSE}
modelEquation <- switch(fitData[1]$modelHint,
                        LL.4 = get_text_file_contents(system.file(file.path("rmd","equations"), "ll4.txt", package = "racas")),
                        Ki = get_text_file_contents(system.file(file.path("rmd","equations"), "ki.txt", package = "racas"))
                        )
cat(modelEquation)
```

***Fit Summary***
* Attempted Fits: `r nrow(fitData)`
* Successful Fits: `r nrow(fitData["algorithm flag status" != "",])`
* Failed Fits: `r nrow(fitData[algorithmFlagStatus == "",])`

***Categories***

```{r categories, echo=FALSE, message = FALSE, fig.show='hold', fig.width=10, fig.height=4, cache=FALSE}
op <- par(mar = c(3,3,1,1) + 0.1)
plot(as.factor(fitData$category),
     cex.axis = 1.2)
```

***Goodness of Fit***

```{r goodnessOfFit, echo=FALSE, message = FALSE, fig.width=10, fig.height=10, cache=FALSE}
goodnessOfFitExists <- !unlist(lapply(fitData$goodnessOfFit.model, is.null))
gf <- rbindlist(fitData[goodnessOfFitExists,]$goodnessOfFit.model)
op <- par(mfrow = c(3, 1),
          oma = c(5,4,0,5) + 0.1,
          mar = c(1,0,1,1) + 0.1)
for(stat in 1:ncol(gf)) {
  variable <- names(gf)[stat]
  dat <- gf[[stat]]
  hist(dat, 
       main = NULL,
       xlab = NULL,
       ylab = NULL,
       border = "black",
       col = "gray",
       cex = 5,
       axes = FALSE)
  axis(1, cex.axis=1.4)
  axis(2, cex.axis=1.4)
  mtext(variable, side = 4, las=1)
}
```

`r paste0('<a href="', '/curveCurator/', experimentCode, '" target="_blank" class="btn">Curate</a>')`
