Database Summary Statistics
========================================================

## Fast Facts
```{r fastFacts, results='asis', echo=FALSE}
cat("Number of protocols: ", numExpProtUsers[2], "\n\n")
cat("Number of experiments: ", numExpProtUsers[1], "\n\n")
cat("Number of users: ", numExpProtUsers[3], "\n\n")
```

### Experiment History
```{r history, echo=FALSE, fig.show='hold', fig.width=10, fig.height=4, cache=FALSE}
plot <- ggplot(history, aes(recorded_by, fill = isOld)) + geom_bar()
plot <- plot + guides(fill = guide_legend(title = NULL))
plot <- plot + scale_fill_manual(values = c("blue", "#56B4E9"), 
                                   labels = c(paste("Newer than \n", 
                                   numWeeks, "Weeks", sep = " "),
                                   paste("Older than \n", numWeeks, "Weeks", sep = " ")))
plot <- plot + labs(title = "Experiment History", 
                      x = NULL, y = "Number of Expermients")
plot <- plot + theme(axis.title = element_text(size = rel(1.5)), 
                       plot.title = element_text(size = rel(2)),
                       axis.text = element_text(size = rel(1.3)))
plot
```

### Experiment Progress
```{r progress, echo=FALSE, fig.show='hold', fig.width=10, fig.height=4, cache=FALSE}
plot1 <- ggplot(progress, aes(recorded_by, fill = status)) + geom_bar()
plot1 <- plot1 + guides(fill = guide_legend(title = NULL))
plot1 <- plot1 + scale_fill_manual(values = c("blue", "#56B4E9"))
plot1 <- plot1 + labs(title = "Experiment Progress", 
                      x = NULL, y = "Number of Expermients")
plot1 <- plot1 + theme(axis.title = element_text(size = rel(1.5)), 
                       plot.title = element_text(size = rel(2)),
                       axis.text = element_text(size = rel(1.3)))
plot1
```

## Database History

```{r analysis, echo=FALSE, fig.show='hold', fig.width=10, fig.height=4, cache=FALSE}
plot3 <- ggplot(analysis, aes(recorded_date, cumulativeSum)) 
plot3 <- plot3 + geom_line(colour = "blue", size = rel(1.3))
plot3 <- plot3 + labs(title = "Calculated Results Over Time", x = "Date", 
                      y = "Number of Results Calculated to Date")
plot3 <- plot3 + theme(axis.title = element_text(size = rel(1.5)), 
                       plot.title = element_text(size = rel(2)),
                       axis.text = element_text(size = rel(1.3)))
plot3
```

```{r subjects, echo=FALSE, fig.show='hold', fig.width=10, fig.height=4, cache=FALSE}
plot2 <- ggplot(subjects, aes(recorded_date, cumulativeSum)) 
plot2 <- plot2 + geom_line(colour = "blue", size = rel(1.3))
plot2 <- plot2 + labs(title = "Samples Measured Over Time", x = "Date", 
                      y = "Number of Samples Measured to Date")
plot2 <- plot2 + theme(axis.title = element_text(size = rel(1.5)), 
                       plot.title = element_text(size = rel(2)),
                       axis.text = element_text(size = rel(1.3)))
plot2
```

```{r values, echo=FALSE, fig.show='hold', fig.width=10, fig.height=4, cache=FALSE}
plot4 <- ggplot(values, aes(recorded_date, cumulativeSum)) 
plot4 <- plot4 + geom_line(colour = "blue", size = rel(1.3))
plot4 <- plot4 + labs(title = "Raw Data Points Acquired Over Time", x = "Date", 
                      y = "Number of Points Acquired to Date")
plot4 <- plot4 + theme(axis.title = element_text(size = rel(1.5)), 
                       plot.title = element_text(size = rel(2)),
                       axis.text = element_text(size = rel(1.3)))
plot4
```
